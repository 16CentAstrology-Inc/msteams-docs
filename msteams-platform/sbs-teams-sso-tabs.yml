### YamlMime:Tutorial
title: Build your tab app with Teams SSO
metadata:
  title: Build your tab app with Teams SSO
  description: In this tutorial, you'll learn to implement Teams SSO in your tab app
  audience: Developer
  level: Beginner
  ms.date: 10/21/2021
  ms.topic: interactive-tutorial
  nextTutorialHref: ~/concepts/authentication/authentication.md
  nextTutorialTitle: Back to Authentication overview
  ms.custom: mvc
  ms.localizationpriority: high
items:
- durationInMinutes: 1
  content: |
    Implement Teams SSO in your Microsoft Teams tab app.
    You'll create a tab app and configure it to authenticate app users with Teams SSO.

- title: Prerequisites
  durationInMinutes: 1
  content: |

   Here's a list of prerequisites for authenticating your app users with Teams SSO for your tab app:

   1. A Teams tab app: You can use the Get started sample available for Teams Toolkit and Visual Studio Code to build a sample tab app.

   1. Register your tab app with Azure AD: Your Teams app users are authenticated using their Teams user credentials and Azure AD provides an access token for them.

   1. Update the manifest file: After you register your app in Azure AD, update the app properties in your app's manifest file.

   1. Get an access token: This step requires your app user to give their consent for using their credentials for user-level permission. Azure AD receives the user credentials and sends an access token to Teams.

   The token is parsed in the tab application using JavaScript, to extract required information, such as the user's email address.

    > [!NOTE]
    > The getAuthToken() is only valid for consenting to a limited set of user-level APIs that is email, profile, offline_access, and OpenId. It is not used for further Graph scopes such as User.Read or Mail.Read. For suggested workarounds, see Get an access token with Graph permissions.

    > [!IMPORTANT]
    > Only user-level Graph API permissions are supported that is, email, profile, offline_access, OpenId. If you must have access to other Graph scopes such as User.Read or Mail.Read, see Get an access token with Graph permissions.
    > It is important that your application's domain name is the same as the domain name you have registered for your Azure AD application.
    > Currently multiple domains per app are not supported.
    > The user must set accessTokenAcceptedVersion to 2 for a new application.

- title: Register tab app with Azure AD
  durationInMinutes: 1
  content: |  

   This section describes the tasks involved in creating a Teams tab that uses SSO. These tasks are language- and framework-agnostic. 

   > [!NOTE]
   > The Microsoft Teams Toolkit can to register the Azure Active Directory (Azure AD) application in a single sign-in (SSO) project.

   In this exercise, you'll learn how to manually register and configure the Azure AD app that can be used to implement SSO in a Microsoft Teams app.

   To complete the registration of your tab app in Azure AD:

   1. [Register your app](#register-your-app)
   1. Configure API permissions with Microsoft Graph
   1. Expose an API for the app and define app scope 
   

   ## Register your app

   In this section, you'll learn to create and register an Azure-based Teams tab app. 

   To register your tab app in Azure AD:

   1. Open a web browser to the [Azure portal](https://ms.portal.azure.com/).
      The Microsoft Azure Portal page opens. 
   
   1. Select **App registrations** icon. 
      
      :::image type="content" source="~/assets/images/authentication/teams-sso-tabs/azure-portal.png" alt-text="Azure Portal page." border="false":::

      The **App registrations** page appears.

   1. Select **+ New registration** icon.

      :::image type="content" source="~/assets/images/authentication/teams-sso-tabs/app-registrations.png" alt-text="New registration page on Azure Portal." border="false":::
      
      The **Register an application** page appears.
   
   1. Enter the app details for your tab app.

      :::image type="content" source="~/assets/images/authentication/teams-sso-tabs/register-app.png" alt-text="App registration page on Azure Portal." border="false":::

      1. Enter the name of your app that will be displayed to the user.
         You can change this name at a later stage, if you want to.

      1. Select the intended types of user accounts that can access your app. For this tutorial, select **Accounts in this organizational directory only (Microsoft only - Single tenant)**.

   1. Select the **Redirect URI** details.

      :::image type="content" source="~/assets/images/authentication/teams-sso-tabs/redirect-uri.png" alt-text="App registration page on Azure Portal." border="true":::

      1. Select the platform where your app will be accessible.
      1. Enter URL for your app. After user authentication is successful, Teams uses this URL to open your app. 
         You can change this URL at a later stage, if needed.

   1. Select **Register**.   
      A message pops up on the browser stating that the app was created.

      :::image type="content" source="~/assets/images/authentication/teams-sso-tabs/app-created-msg.png" alt-text="App registration page on Azure Portal." border="true":::

      The app is created and displayed.

      :::image type="content" source="~/assets/images/authentication/teams-sso-tabs/tab-app-created.png" alt-text="App registration page on Azure Portal." border="false":::

    1. Note and save the **Application ID**. You'll need it for updating the app manifest.

    Your Teams tab app is created.

   ## Configure API permissions with Microsoft Graph

   In this section, you'll learn to configure API permissions with Microsoft Graph, such as User.Read, email, offline_access, and more.

   To configure API permissions:

   1. Select **API permission** from the left pane.
      The **API permissions** page appears.

      :::image type="content" source="~/assets/images/authentication/teams-sso-tabs/api-permission-menu.png" alt-text="App permissions menu option." border="false":::

   1. Select **+ Add permissions** to add Microsoft Graph API permissions.
      
      :::image type="content" source="~/assets/images/authentication/teams-sso-tabs/app-permission.png" alt-text="App permissions page." border="false":::
      
      The **Request API permissions** page appears.

   1. Select **Microsoft Graph**.

      :::image type="content" source="~/assets/images/authentication/teams-sso-tabs/request-api-permission.png" alt-text="Request API permissions page." border="false":::

      The options for Graph permissions display.

   1. Select **Delegated permissions** to view the list of possible permission that you can select.

      :::image type="content" source="~/assets/images/authentication/teams-sso-tabs/delegated-permission.png" alt-text="Delegated permissions." border="false":::

   1. Select relevant permissions for your app. For this tutorial, select **email** and **offline_access**, and then select **Add permissions**.

      :::image type="content" source="~/assets/images/authentication/teams-sso-tabs/select-permission.png" alt-text="Delegated permissions." border="true":::

      A message pops up on the browser stating that the app was created.

      :::image type="content" source="~/assets/images/authentication/teams-sso-tabs/updated-permission-msg.png" alt-text="Delegated permissions." border="false":::

      The added permissions are displayed in the **API permissions** page.

      :::image type="content" source="~/assets/images/authentication/teams-sso-tabs/configured-permissions.png" alt-text="Delegated permissions." border="true":::

   Next, you will expose API and define scope.    
  
   