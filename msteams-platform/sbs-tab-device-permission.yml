### YamlMime:Tutorial
title: Tab device permission demo
metadata:
  title: Tab Device Permission Demo
  description: In this tutorial, you'll learn to give tab device permission for Microsoft Teams sample apps.
  audience: Developer
  level: Beginner
  ms.date: 12/10/2021
  ms.topic: interactive-tutorial
  nextTutorialHref: bots/how-to/authentication/auth-aad-sso-bots.md
  nextTutorialTitle: Read more on bot authentication
  ms.custom: mvc
  ms.localizationpriority: none
items:
- durationInMinutes: 1
  content: |
    Teams app that require device permissions, such as location, camera or microphone access, now require users to manually grant permission at a per app level in the web browser. Previously, the browser handled how to grant access permissions, but now these permissions are handled in Microsoft Teams.

    This step-by-step guide helps you to do tab device permission demo in Microsoft Teams. You'll see the following output:

      ![desktop3](~/assets/images/tab-device-permission/sbs-tab-device-permission-location.PNG)


- title: Prerequisites
  durationInMinutes: 1
  content: |
    Ensure that you install the following tools and set up your development environment:  

    * Microsoft Teams with an account (not a guest account)
    * [ngrok](https://ngrok.com/) or equivalent tunneling solution
    * Visual Studio 2019 or the latest version
    * [Microsoft 365 developer account](https://docs.microsoft.com/en-us/microsoftteams/platform/concepts/build-and-test/prepare-your-o365-tenant) or access to Teams account with the appropriate permissions to install an app

- title: Configure and run the Tab Device Permissin app on Teams
  durationInMinutes: 1
  content: |
    Configure the tab device permission sample in Microsoft Teams.

    **To configure and run your tab device permission sample**

    1. Open Git Bash and clone a repository **git clone https://github.com/OfficeDev/Microsoft-Teams-Samples.git**. Ensure that you note the **Path** where the repository is cloned.
    1. In the Windows Explorer, go to **Microsoft-Teams-Samples > samples > tab-device-permissions > nodejs** folder.
    1. Open ngrok, run the below command.

    ```bash
    npm install
    ```
    1. Run the application in the ngrok using following command.
       
    ```bash
    npm start
    ```
    1. Begin your tunnelling service to get an https endpoint.
    1. Go to **Microsoft-Teams-Samples > samples > tab-device-permissions > nodejs**.
    1. Start an ngrok tunnel with the following command (you'll need the https endpoint to update the manifest file):

    ```bash
    ngrok http 3000 --host-header=localhost
    ```  
        
    **To run the tab device permission by uploading the manifest.zip file in Teams**

    1. Create an app manifest.
    1. In the Windows Explorer, go to **Microsoft-Teams-Samples > samples > tab-device-permissions > nodejs > appPackage** folder.
    1. Open the **manifest.json** file.
    1. In the **manifest.json** file, find **<<BASE_URI_DOMAIN>>** and replace it with your https endpoint from ngrok excluding the "https://" part.
    1. Zip the files in the **appPackage/folder** as manifest.zip.
    1. Go to Teams.
    1. To upload **manifest.zip**, select **Apps > Upload a custom app** and open **manifest.zip**.
    1. Select **Tab Device Permission** app.
    1. Select **Add** to add the tab device permission app.

      ![addbrowserteams](~/assets/images/tab-device-permission/sbs-add-browser-teams.png)

    1. Open **Tab Device Permission** and select **Device Permission Tab**.
    1. Also open mobile teams and you will see the below outputs:

    # [Browser](#tab/Browser)

      ![getlocationbrowserteams](~/assets/images/tab-device-permission/sbs-tab-device-permission-browser-mobile-get-location.png)

    # [Mobile](#tab/Mobile)

      ![mobileteams](~/assets/images/tab-device-permission/mobile-teams-output.png)

      ![mobileteams](~/assets/images/tab-device-permission/mobile-teams.png)

    ---

- title: Test your app
  durationInMinutes: 1
  content: |
  
     # [Browser](#tab/Browser)

    Select **Get Location** and you will see the below output.

      ![locationresultbrowserteams](~/assets/images/tab-device-permission/sbs-location-result.png)

    # [Mobile](#tab/Mobile)

    Click on respective button to test the scenario. You will get prompt to accept permission request as below.

      ![mobilepromptteams](~/assets/images/tab-device-permission/sbs-prompt-mobile.png)

      ![mobileappteams](~/assets/images/tab-device-permission/prompt-mobile-app.png)

    --- 
    
- title: Complete challenge
  durationInMinutes: 1
  content: |
    Did you come up with something like this?

      ![tabdeviceimage](~/assets/images/tab-device-permission/sbs-tab-device-permission-location.PNG)


- content: |
    You've completed the tutorial to give tab device permission for Microsoft Teams sample apps.

